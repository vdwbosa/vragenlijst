<!DOCTYPE html>

<html lang="nl">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>Vragenlijst Duurzame loopbaan</title>
<style>
:root{--bg:#f7f8fb;--card:#fff;--muted:#666;--accent:#2b6cb0;font-family:Inter, Roboto, Arial, sans-serif}
body{margin:0;background:var(--bg);color:#1a202c}
.container{max-width:1100px;margin:28px auto;padding:18px}
header{display:flex;align-items:center;gap:16px;margin-bottom:12px}
h1{font-size:20px;margin:0}
p.lead{margin:0;color:var(--muted);font-size:13px}
.grid{display:grid;grid-template-columns:1fr 480px;gap:18px}
.card{background:var(--card);padding:12px;border-radius:10px;box-shadow:0 6px 18px rgba(20,20,30,0.04)}
form .cluster{border:1px dashed #eee;padding:8px;border-radius:8px;margin-bottom:8px}
.cluster h3{margin:0 0 6px 0;font-size:14px}
.q{display:flex;align-items:center;gap:8px;padding:6px 0;border-bottom:1px solid #fafafa}
.q:last-child{border-bottom:none}
.q label{flex:1 1 60%; font-size:13px; word-break: break-word;}
.radios{flex:0 0 auto; display:flex; gap:6px;}
input[type=radio]{transform:scale(1.05)}
.actions{display:flex;gap:8px;margin-top:10px}
button{background:var(--accent);color:#fff;border:none;padding:8px 12px;border-radius:8px;cursor:pointer}
button.secondary{background:#e2e8f0;color:#111}
.chart-area{display:flex;flex-direction:column;align-items:center;gap:8px}
canvas{background:transparent}
.legend{display:flex;gap:8px;flex-wrap:wrap}
.legend .item{display:flex;gap:6px;align-items:center;font-size:13px}
.colorbox{width:14px;height:14px;border-radius:3px}
.downloads{display:flex;gap:8px;margin-top:6px}
.small{font-size:12px;color:var(--muted)}
footer{margin-top:18px;text-align:center;color:var(--muted);font-size:12px}
@media(max-width:980px){.grid{grid-template-columns:1fr}}
</style>
</head>
<body>
<div class="container">
<header>
<h1>Vragenlijst Duurzame loopbaan</h1>
<p class="lead">Vul de vragen in en klik op "Toon resultaat". De visuele voorstelling wordt direct gegenereerd. Download het rapport als pdf.</p>
</header>
<div class="grid">
<div class="card">
<form id="survey"></form>
</div>
<div class="card chart-area">
<div style="width:100%">
<canvas height="480" id="chart" width="480"></canvas>
</div>
<div class="legend" id="legend"></div>
<div class="downloads"><button id="downloadPdf" style="margin-top:10px">Download PDF</button></div>
<div class="small">Beweeg over een sector voor de details.</div>
</div>
</div>
<footer class="small"></footer>
</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const clusters=[
{name:'Werkbaarheid',questions:['Ik ervaar een goede balans tussen werk en privé.','De werkdruk is voor mij goed te hanteren.','Ik voel me mentaal in staat om mijn werk goed te blijven doen.','Ik voel me fysiek in staat om mijn werk goed te blijven doen.','Aan het einde van mijn werkdag heb ik meestal nog voldoende energie over.','Ik kan tijdens drukke periodes voldoende terugvallen op collega\'s of mijn leidinggevende.','Mijn werkomgeving ondersteunt mij in het gezond en efficiënt uitvoeren van mijn taken.','Ik heb voldoende autonomie in mijn werk om mijn dag zelf in te richten.','Ik voel mij comfortabel om mijn grenzen aan te geven.','Mijn werksituatie is voor mij op langere termijn houdbaar.'],keywords:['BALANS','WERKDRUK','MENTAAL','FYSIEK','ENERGIE','SUPPORT','UITVOERING','AUTONOMIE','GRENZEN','TERMIJN']},
{name:'Inzetbaarheid',questions:['Ik kan mijn sterktes en competenties goed inzetten in mijn huidige functie.','Mijn taken sluiten aan bij wat ik goed kan én leuk vind.','Als er iets verandert in mijn takenpakket, kan ik daar op een passende manier mee omgaan.','Ik word voldoende uitgedaagd in mijn functie.','Ik kan goed omgaan met veranderingen in mijn werkomgeving.','Mijn werk sluit aan bij mijn interesses en drijfveren.','Ik beschik over de juiste competenties om ook in de toekomst inzetbaar te blijven.','Er is ruimte om mijn taken aan te passen aan mijn sterktes.','Ik kan makkelijk schakelen tussen verschillende taken of rollen.','Ik voel mij breed inzetbaar binnen de organisatie.'],keywords:['STERKTES','ENERGIE','FLEXIBILITEIT','UITDAGING','AANPASSINGSVERMOGEN','INTERESSE','TOEKOMST','CRAFTING','DIVERSITEIT','BREED INZETBAAR']},
{name:'Groei',questions:['Ik heb voldoende kansen om mezelf te ontwikkelen in mijn functie.','Ik leer regelmatig nieuwe dingen die mij helpen in mijn werk.','Mijn leidinggevende stimuleert mijn professionele groei.','Ik weet welke ontwikkelmogelijkheden er zijn binnen de organisatie.','Ik heb een duidelijk beeld van mijn loopbaanrichting of doelen.','Ik krijg voldoende ondersteuning om mijn leer- en ontwikkelbehoeften vorm te geven.','Ik heb vertrouwen in mijn toekomstperspectief binnen de organisatie.','Ik voel me gestimuleerd om mijn sterktes en competenties verder te ontwikkelen.','Ik krijg voldoende ruimte om te experimenteren en te leren.','Mijn werk biedt mij kansen om door te groeien als ik dat wil.'],keywords:['KANSEN','LEREN','STIMULEREN','LEERMOGELIJKHEDEN','LOOPBAANRICHTING','BEHOEFTEN','TOEKOMSTPERSPECTIEF','ONTWIKKELEN','EXPERIMENTEREN','DOORGROEIEN']},
{name:'Verbinding',questions:['Ik voel me betrokken bij mijn team en collega’s.','Ik ervaar voldoende waardering en erkenning voor mijn werk.','Ik voel me verbonden met de doelen en waarden van de organisatie.','Ik voel mij veilig om open te praten met mijn leidinggevende.','Er wordt binnen mijn organisatie op een open en transparante manier gecommuniceerd.','Ik ervaar een goede samenwerking met mijn directe collega’s.','Er is onderling vertrouwen binnen mijn team.','Ik voel me onderdeel van het grotere geheel binnen de organisatie.','Ik krijg voldoende feedback over mijn functioneren.','Ik voel me gewaardeerd als persoon, niet alleen om wat ik doe.'],keywords:['BETROKKEN','ERKENNING','VERBONDEN','VEILIG','COMMUNICATIE','SAMENWERKING','VERTROUWEN','GEHEEL','FEEDBACK','WAARDERING']}
];
const clusterColors={'Werkbaarheid':'rgba(20,200,208,0.9)','Inzetbaarheid':'rgba(254,218,123,0.9)','Groei':'rgba(160,233,149,0.9)','Verbinding':'rgba(248,97,129,0.9)'};

const form=document.getElementById('survey');
clusters.forEach(cl=>{
const div=document.createElement('div'); div.className='cluster';
const h3=document.createElement('h3'); h3.textContent=cl.name; div.appendChild(h3);
cl.questions.forEach((q,i)=>{
const qdiv=document.createElement('div'); qdiv.className='q';
const label=document.createElement('label'); label.textContent=`${i+1}. ${q}`; qdiv.appendChild(label);
const radios=document.createElement('div'); radios.className='radios';
for(let v=1;v<=5;v++){const lab=document.createElement('label'); lab.style.marginRight='6px';
const inp=document.createElement('input'); inp.type='radio'; inp.name=`${cl.name}_${i+1}`; inp.value=v; inp.required=true;
lab.appendChild(inp); lab.appendChild(document.createTextNode(' '+v)); radios.appendChild(lab);}
qdiv.appendChild(radios); div.appendChild(qdiv);
});
form.appendChild(div);
});

const showBtn=document.createElement('button'); showBtn.type='button'; showBtn.textContent='Toon resultaat'; showBtn.style.marginTop='10px'; form.appendChild(showBtn);

const resetBtn=document.createElement('button'); resetBtn.type='button'; resetBtn.className='secondary'; resetBtn.textContent='Reset'; resetBtn.onclick=()=>{form.reset();chart.data.labels=[];chart.data.datasets[0].data=[];chart.update();document.getElementById('legend').innerHTML='';}; form.appendChild(resetBtn);

const ctx=document.getElementById('chart').getContext('2d');
const chart=new Chart(ctx,{type:'polarArea',data:{labels:[],datasets:[{data:[],backgroundColor:[],borderColor:[],borderWidth:0.6,fullQuestions:[]} ] },options:{responsive:true,maintainAspectRatio:true,plugins:{legend:{display:false},tooltip:{callbacks:{label:function(ctx){return ctx.dataset.fullQuestions[ctx.dataIndex]+' — score: '+ctx.formattedValue;}}}},scales:{r:{min:0,max:5,ticks:{stepSize:1}}}}});

function buildDataset(){
const labels=[],data=[],bg=[],border=[],fullQ=[];
for(const cl of clusters){for(let i=0;i<10;i++){const radios=document.getElementsByName(`${cl.name}_${i+1}`); let val=null; for(const r of radios) if(r.checked) val=Number(r.value); if(val===null){alert(`Selecteer alle vragen (missende: ${cl.name} ${i+1})`); return null;} labels.push(cl.keywords[i]); data.push(val); bg.push(clusterColors[cl.name]); border.push('rgba(0,0,0,0.08)'); fullQ.push(cl.questions[i]);}}
return {labels,data,bg,border,fullQ};
}

showBtn.onclick=()=>{
const ds=buildDataset(); if(!ds) return;
chart.data.labels=ds.labels; chart.data.datasets[0].data=ds.data; chart.data.datasets[0].backgroundColor=ds.bg; chart.data.datasets[0].borderColor=ds.border; chart.data.datasets[0].fullQuestions=ds.fullQ; chart.update();
document.getElementById('chart').scrollIntoView({ behavior: 'smooth', block: 'start' });
const legend=document.getElementById('legend'); legend.innerHTML=''; for(const key of Object.keys(clusterColors)){const it=document.createElement('div'); it.className='item'; const box=document.createElement('span'); box.className='colorbox'; box.style.background=clusterColors[key]; it.appendChild(box); it.appendChild(document.createTextNode(key)); legend.appendChild(it);}
};

document.getElementById('downloadPng').addEventListener('click',()=>{if(!chart.data.datasets[0].data.length){alert('Maak eerst de grafiek via "Toon resultaat"');return;}const url=chart.toBase64Image();const a=document.createElement('a');a.href=url;a.download='polar_area_chart.png';a.click();});
document.getElementById('downloadCsv').addEventListener('click',()=>{
const ds=buildDataset(); if(!ds) return;
const rows=[['cluster','question_index','question','score']];
let idx=0; for(const cl of clusters){for(let i=0;i<10;i++){rows.push([cl.name,i+1,cl.questions[i],ds.data[idx]]); idx++;}}
const csvContent='data:text/csv;charset=utf-8,'+rows.map(r=>r.join(',')).join('\n'); const encodedUri=encodeURI(csvContent); const link=document.createElement('a'); link.setAttribute('href',encodedUri); link.setAttribute('download','answers.csv'); document.body.appendChild(link); link.click(); document.body.removeChild(link);
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
document.getElementById('downloadPdf').addEventListener('click', async () => {
if (!chart.data.datasets[0].data.length) {
alert('Maak eerst de grafiek via "Toon resultaat"');
return;
}

const { jsPDF } = window.jspdf;
const doc = new jsPDF();

doc.setFontSize(14);
doc.text("Resultaat vragenlijst duurzame loopbaan", 20, 20);

let y = 30;
clusters.forEach((cl) => {
doc.setFontSize(12);
doc.text(cl.name, 20, y);
y += 6;
cl.questions.forEach((q, i) => {
const radios = document.getElementsByName(`${cl.name}_${i + 1}`);
let val = "";
for (const r of radios) if (r.checked) val = r.value;
doc.setFontSize(10);
const text = `${i + 1}. ${q} — score: ${val}`;
const lines = doc.splitTextToSize(text, 170);
doc.text(lines, 20, y);
y += lines.length * 5;
if (y > 270) {
doc.addPage();
y = 20;
}
});
y += 4;
});

// Add chart image
const chartCanvas = document.getElementById('chart');
const chartImage = chartCanvas.toDataURL("image/png");
doc.addPage();
doc.setFontSize(12);
doc.text("Visuele voorstelling", 20, 20);
doc.addImage(chartImage, "PNG", 20, 30, 160, 160);

// Add legend
doc.setFontSize(12);
doc.text("Legenda", 20, 200);
let ly = 210;
Object.entries(clusterColors).forEach(([key, color]) => {
const rgb = color.match(/\d+/g).slice(0,3).map(Number);
doc.setFillColor(...rgb);
doc.rect(20, ly - 5, 5, 5, 'F');
doc.text(key, 30, ly);
ly += 8;
});

doc.save("Resultaat vragenlijst duurzame loopbaan.pdf");
});
</script>
</body>
</html>
